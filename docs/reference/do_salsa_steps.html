<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform SALSA steps for threshold detection — do_salsa_steps • salsa</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Perform SALSA steps for threshold detection — do_salsa_steps" />

<meta property="og:description" content="Perform SALSA steps for threshold detection" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">salsa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jmw86069/salsa">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform SALSA steps for threshold detection</h1>
    <small class="dont-index">Source: <a href='https://github.com/jmw86069/salsa/blob/master/R/salsa-fit.R'><code>R/salsa-fit.R</code></a></small>
    <div class="hidden name"><code>do_salsa_steps.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Perform SALSA steps for threshold detection</p>
    
    </div>

    <pre class="usage"><span class='fu'>do_salsa_steps</span>(<span class='no'>x</span>, <span class='kw'>n_vector</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n_start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>max_step</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>step_size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>count_vector</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>dists</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"frechet"</span>,
  <span class='st'>"frechet-weibull"</span>), <span class='kw'>cache_fr</span> <span class='kw'>=</span> <span class='fu'>cache_filesystem</span>(<span class='st'>"./cache_fr"</span>),
  <span class='kw'>cache_fr_wei</span> <span class='kw'>=</span> <span class='fu'>cache_filesystem</span>(<span class='st'>"./cache_fr_wei"</span>),
  <span class='kw'>param_fr_wei</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>numeric vector of counts, either the number of
UMI per cell, or the number of UMI per gene.</p></td>
    </tr>
    <tr>
      <th>n_vector, n_start, max_step, step_size, count_vector</th>
      <td><p>arguments passed to <code>get_salsa_steps()</code> which returns
<code>count_vector</code>. If <code>count_vector</code> is supplied, it is
used without modification.</p></td>
    </tr>
    <tr>
      <th>dists</th>
      <td><p>character vector determining which distribution
fit functions to calculate, <code>"frechet"</code> fits the Frechet
distribution, <code>"frechet-weibull"</code> fits the five-parameter
combined Frechet and Weibull distributions. Typically the
Frechet parameters are used to define the upper bound,
and the Frechet-Weibull parameters are used to define the
lower bound.</p></td>
    </tr>
    <tr>
      <th>cache_fr, cache_fr_wei</th>
      <td><p>list objects output from
<code><a href='https://www.rdocumentation.org/packages/memoise/topics/cache_filesystem'>memoise::cache_filesystem()</a></code> used to store cached
distribution fit results. When either are NULL, the
memoise cache steps are disabled, and the functions are
called directly.</p></td>
    </tr>
    <tr>
      <th>param_fr_wei</th>
      <td><p><code>data.frame</code> output from <code>params_fr_wei()</code>
which defines the parameter upper and lower limits, and
start values for each parameter. If <code>NULL</code> then the
default values from <code>params_fr_wei()</code> are used.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are ignored.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>list</code> with one element for each value in <code>count_vector</code>,
where each list element contains a list with one entry for
each value in argument <code>dists</code> containing the fit parameters
for each selected distribution, as well as an entry <code>"min_count"</code>
which contains the minimum counts to use in each fit. When
<code>dists</code> contains <code>"frechet-weibull"</code> each list includes
<code>"lower_bound"</code>. When <code>dists</code> contains <code>"frechet"</code> each list
includes <code>"upper_bound"</code>. The output is intended to be passed
to <code><a href='https://www.rdocumentation.org/packages/salsa/topics/get_salsa_table'>get_salsa_table()</a></code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is a wrapper around <code><a href='https://www.rdocumentation.org/packages/salsa/topics/fitdist_fr'>fitdist_fr()</a></code> and
<code><a href='https://www.rdocumentation.org/packages/salsa/topics/fitdist_fr_wei'>fitdist_fr_wei()</a></code>, which iterates through a wide range
of possible thresholds to determine the fit parameters,
and associated lower and upper bounds. The results
are intended to be plotted to determine appropriate
thresholds to use when calculating the lower and upper
bounds for barcodes and genes in a single cell RNA-seq
dataset.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other SALSA core functions: <code><a href='https://www.rdocumentation.org/packages/salsa/topics/get_salsa_table'>get_salsa_table</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>salsa</span>);
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>oz2_numi_per_cell</span>);
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>oz2_numi_per_cell</span>$<span class='no'>count</span>[<span class='no'>oz2_numi_per_cell</span>$<span class='no'>count</span> <span class='kw'>&gt;=</span> <span class='fl'>16</span>];
<span class='no'>x_salsa</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/salsa/topics/do_salsa_steps'>do_salsa_steps</a></span>(<span class='no'>x</span>,
   <span class='kw'>count_vector</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>16</span>,<span class='fl'>32</span>,<span class='fl'>128</span>),
   <span class='kw'>cache_fr</span><span class='kw'>=</span><span class='kw'>NULL</span>,
   <span class='kw'>cache_fr_wei</span><span class='kw'>=</span><span class='kw'>NULL</span>);
<span class='no'>x_df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/salsa/topics/get_salsa_table'>get_salsa_table</a></span>(<span class='no'>x_salsa</span>);
<span class='no'>x_df</span>;</div><div class='output co'>#&gt;     count    shape    scale fr_weight fr_shape  fr_scale wei_shape wei_scale
#&gt; 16     16       NA       NA      0.99      1.5  25.24369  1.514120  1775.742
#&gt; 32     32 2.038619 138.2035      0.99      1.5 178.24735  1.500003  1700.841
#&gt; 128   128 2.067224 265.6946      0.99      1.8 180.50922  1.500004  1699.818
#&gt;     lower_bound upper_bound
#&gt; 16     161.1956          NA
#&gt; 32     480.9103     555.284
#&gt; 128    410.7675    1054.265</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Oswaldo Lozoya.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

